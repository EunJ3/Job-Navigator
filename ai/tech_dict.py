# ai/tech_dict.py
import re

TECH_STACK = [
    # ✅ 프론트엔드 기술스택
    "HTML",
    "CSS",
    "JavaScript",
    "TypeScript",
    "React",
    "Vue",
    "Angular",
    "Svelte",
    "Next.js",
    "Nuxt.js",
    "Tailwind",
    "Bootstrap",
    "jQuery",
    "Remix",
    "SvelteKit",
    "Astro",
    "Vite",
    "Webpack",
    "Parcel",
    "Sass",
    "Less",
    "Styled Components",
    "Emotion",
    "Material-UI",
    "Ant Design",
    "Zustand",
    "Redux",
    "MobX",
    "Recoil",
    "Jotai",
    "Context API",
    "React Query",
    "SWR",
    "Apollo Client",
    "Relay",
    "Framer Motion",
    "React Spring",
    "Lottie",
    "GSAP",
    "Storybook",
    "Chromatic",
    "Figma",
    "Adobe XD",
    "PWA",
    "Web Components",
    "Lit",
    "Stencil",
    # ✅ 백엔드 기술스택
    "파이썬",
    "자바",
    "스프링",
    "스프링부트",
    "자바스프링",
    "장고",
    "플라스크",
    "노드",
    "노드JS",
    "Python",
    "Java",
    "C",
    "C++",
    "C#",
    "Go",
    "Kotlin",
    "PHP",
    "Ruby",
    "Node.js",
    "Spring Boot",
    "Django",
    "Flask",
    "FastAPI",
    "Express",
    "NestJS",
    "Rust",
    "Scala",
    "Elixir",
    "Clojure",
    "Haskell",
    "Dart",
    "Spring",
    "Spring Security",
    "Spring Data",
    "Hibernate",
    "Laravel",
    "CodeIgniter",
    "Symfony",
    "CakePHP",
    "Rails",
    "Sinatra",
    "Grape",
    "Gin",
    "Echo",
    "Fiber",
    "Chi",
    "ASP.NET Core",
    "Entity Framework",
    ".NET Framework",
    "Actix Web",
    "Rocket",
    "Warp",
    "Axum",
    "Deno",
    "Bun",
    "Fastify",
    "Koa",
    "Hapi",
    "GraphQL",
    "REST API",
    "gRPC",
    "WebSocket",
    "tRPC",
    "Ruby on Rails",
    # ✅ AI / Data 기술스택
    "텐서플로",
    "텐서플로우",
    "파이토치",
    "케라스",
    "판다스",
    "넘파이",
    "싸이킷런",
    "사이킷런",
    "Pandas",
    "NumPy",
    "Scikit-learn",
    "TensorFlow",
    "PyTorch",
    "Keras",
    "OpenCV",
    "XGBoost",
    "LightGBM",
    "HuggingFace",
    "Transformers",
    "HuggingFace Transformers",
    "Hadoop",
    "Spark",
    "Kafka",
    "Airflow",
    "JAX",
    "Flax",
    "Optax",
    "MLX",
    "CuPy",
    "Dask",
    "Matplotlib",
    "Seaborn",
    "Plotly",
    "Bokeh",
    "Altair",
    "Jupyter",
    "JupyterLab",
    "Google Colab",
    "Kaggle Notebooks",
    "MLflow",
    "Weights & Biases",
    "Neptune",
    "ClearML",
    "OpenAI API",
    "Anthropic Claude",
    "LangChain",
    "LlamaIndex",
    "NLTK",
    "spaCy",
    "Gensim",
    "TextBlob",
    "BERT",
    "GPT",
    "Apache Flink",
    "Apache Storm",
    "Apache Pulsar",
    "RabbitMQ",
    "Elasticsearch",
    "Solr",
    "Lucene",
    "DVC",
    "Great Expectations",
    "Feast",
    "Kubeflow",
    "Ray",
    "Horovod",
    "DeepSpeed",
    "FairScale",
    "Julia",
    # ✅ Mobile 기술스택
    "Kotlin",
    "Swift",
    "Flutter",
    "React Native",
    "Android",
    "iOS",
    "Android SDK",
    "iOS SDK",
    # ✅ 공통 데이터베이스 (프론트, 백, AI 모두 연관)
    "마이에스큐엘",
    "마이SQL",
    "오라클",
    "몽고디비",
    "몽고DB",
    "마리아DB",
    "마리아디비",
    "레디스",
    "에스큐엘라이트",
    "MySQL",
    "PostgreSQL",
    "MariaDB",
    "MongoDB",
    "Redis",
    "SQLite",
    "Oracle",
    "SQL Server",
    "DB2",
    "Sybase",
    "Cassandra",
    "CouchDB",
    "Amazon DynamoDB",
    "Azure Cosmos DB",
    "Neo4j",
    "ArangoDB",
    "OrientDB",
    "Amazon Neptune",
    "InfluxDB",
    "TimescaleDB",
    "QuestDB",
    "ClickHouse",
    "Memcached",
    "Hazelcast",
    "Apache Ignite",
    "Pinecone",
    "Weaviate",
    "Qdrant",
    "Chroma",
    "Milvus",
    "Prisma",
    "TypeORM",
    "Sequelize",
    "Mongoose",
    "SQLAlchemy",
    "Knex.js",
    "Drizzle",
    "Kysely",
    "MikroORM",
    "DuckDB",
    "ERDCloud",
    "DBeaver",
    "DBVisualizer",
    # ✅ 클라우드 기본 (AI/백엔드 필수)
    "아마존",
    "아마존웹서비스",
    "구글클라우드",
    "애저",
    "AWS",
    "Azure",
    "GCP",
    "Google Cloud",
    "Oracle Cloud",
    "IBM Cloud",
    "Alibaba Cloud",
    "Tencent Cloud",
    "DigitalOcean",
    "Linode",
    "Vultr",
    "Hetzner",
    "Vercel",
    "Netlify",
    "Cloudflare",
    "Fastly",
    "Heroku",
    "Railway",
    "Render",
    "Fly.io",
    "Docker",
    "Kubernetes",
    "Helm",
    "Istio",
    "Linkerd",
    "Terraform",
    "Ansible",
    "Pulumi",
    "CloudFormation",
    "Jenkins",
    "GitHub Actions",
    "GitLab CI",
    "CircleCI",
    "Travis CI",
    "Prometheus",
    "Grafana",
    "Jaeger",
    "Zipkin",
    "Datadog",
    "AWS Lambda",
    "Azure Functions",
    "Google Cloud Functions",
    "Cloudflare Workers",
    "HCL (Terraform)",
]

JOB_TECH_MAP = {
    "프론트엔드": [
        "HTML",
        "CSS",
        "JavaScript",
        "TypeScript",
        "React",
        "Vue",
        "Angular",
        "Svelte",
        "Next.js",
        "Nuxt.js",
        "Tailwind",
        "Bootstrap",
        "Redux",
        "Emotion",
        "Figma",
        "Webpack",
        "Material-UI",
        "Ant Design",
        "jQuery",
        "Remix",
        "SvelteKit",
        "Astro",
        "Vite",
        "Parcel",
        "Sass",
        "Less",
        "Styled Components",
        "Context API",
        "React Query",
        "SWR",
        "Apollo Client",
        "Relay",
        "Framer Motion",
        "React Spring",
        "Lottie",
        "GSAP",
        "Storybook",
        "Chromatic",
        "Adobe XD",
        "PWA",
        "Web Components",
        "Lit",
        "Stencil",
    ],
    "백엔드": [
        "파이썬",
        "자바",
        "스프링",
        "스프링부트",
        "자바스프링",
        "장고",
        "플라스크",
        "노드",
        "노드JS",
        "TypeScript",
        "Python",
        "Java",
        "C",
        "C++",
        "C#",
        "Go",
        "Kotlin",
        "PHP",
        "Ruby",
        "Node.js",
        "Spring Boot",
        "Django",
        "Flask",
        "FastAPI",
        "Express",
        "NestJS",
        "Rust",
        "Scala",
        "Elixir",
        "Clojure",
        "Haskell",
        "Dart",
        "Spring",
        "Spring Security",
        "Spring Data",
        "Hibernate",
        "Laravel",
        "CodeIgniter",
        "Symfony",
        "CakePHP",
        "Rails",
        "Sinatra",
        "Grape",
        "Gin",
        "Echo",
        "Fiber",
        "Chi",
        "ASP.NET Core",
        "Entity Framework",
        ".NET Framework",
        "Actix Web",
        "Rocket",
        "Warp",
        "Axum",
        "Deno",
        "Bun",
        "Fastify",
        "Koa",
        "Hapi",
        "GraphQL",
        "REST API",
        "gRPC",
        "WebSocket",
        "tRPC",
    ],
    "모바일": ["Kotlin", "Swift", "Flutter", "React Native", "Android", "iOS"],
    "AI/ML": [
        "텐서플로",
        "텐서플로우",
        "파이토치",
        "케라스",
        "판다스",
        "넘파이",
        "싸이킷런",
        "사이킷런",
        "HuggingFace Transformers",
        "Pandas",
        "NumPy",
        "Scikit-learn",
        "TensorFlow",
        "PyTorch",
        "Keras",
        "OpenCV",
        "XGBoost",
        "LightGBM",
        "HuggingFace",
        "Transformers",
        "JAX",
        "Flax",
        "Optax",
        "MLX",
        "CuPy",
        "Dask",
        "Matplotlib",
        "Seaborn",
        "Plotly",
        "Bokeh",
        "Altair",
        "Jupyter",
        "JupyterLab",
        "Google Colab",
        "Kaggle Notebooks",
        "MLflow",
        "Weights & Biases",
        "Neptune",
        "ClearML",
        "OpenAI API",
        "Anthropic Claude",
        "LangChain",
        "LlamaIndex",
        "NLTK",
        "spaCy",
        "Gensim",
        "TextBlob",
        "BERT",
        "GPT",
        "Ray",
        "Horovod",
        "DeepSpeed",
        "FairScale",
        "Apache Flink",
        "Apache Storm",
        "Apache Pulsar",
    ],
    "데이터베이스": [
        "마이에스큐엘",
        "마이SQL",
        "오라클",
        "몽고디비",
        "몽고DB",
        "마리아DB",
        "마리아디비",
        "레디스",
        "에스큐엘라이트",
        "MySQL",
        "PostgreSQL",
        "MariaDB",
        "MongoDB",
        "Redis",
        "SQLite",
        "Oracle",
        "SQL Server",
        "DB2",
        "Sybase",
        "Cassandra",
        "CouchDB",
        "Amazon DynamoDB",
        "Azure Cosmos DB",
        "Neo4j",
        "ArangoDB",
        "OrientDB",
        "Amazon Neptune",
        "InfluxDB",
        "TimescaleDB",
        "QuestDB",
        "ClickHouse",
        "Memcached",
        "Hazelcast",
        "Apache Ignite",
        "Pinecone",
        "Weaviate",
        "Qdrant",
        "Chroma",
        "Milvus",
        "Prisma",
        "TypeORM",
        "Sequelize",
        "Mongoose",
        "SQLAlchemy",
        "Knex.js",
        "Drizzle",
        "Kysely",
        "MikroORM",
    ],
    "클라우드": [
        "아마존",
        "아마존웹서비스",
        "구글클라우드",
        "애저",
        "AWS",
        "Azure",
        "GCP",
        "Google Cloud",
        "Oracle Cloud",
        "IBM Cloud",
        "Alibaba Cloud",
        "Tencent Cloud",
        "DigitalOcean",
        "Linode",
        "Vultr",
        "Hetzner",
        "Vercel",
        "Netlify",
        "Cloudflare",
        "Fastly",
        "Heroku",
        "Railway",
        "Render",
        "Fly.io",
        "Docker",
        "Kubernetes",
        "Helm",
        "Istio",
        "Linkerd",
        "Terraform",
        "Ansible",
        "Pulumi",
        "CloudFormation",
        "Jenkins",
        "GitHub Actions",
        "GitLab CI",
        "CircleCI",
        "Travis CI",
        "Prometheus",
        "Grafana",
        "Jaeger",
        "Zipkin",
        "Datadog",
        "AWS Lambda",
        "Azure Functions",
        "Google Cloud Functions",
        "Cloudflare Workers",
    ],
}


# 기술 키워드 정규화 매핑 사전
# 표준 기술명: { 다양한 표현들 }

TECH_EQUIVALENTS = {
    "Python": {"python", "파이썬", "파이선"},
    "JavaScript": {"javascript", "자바스크립트", "js"},
    "TypeScript": {"typescript", "타입스크립트"},
    "Java": {"java", "자바"},
    "Node.js": {"nodejs", "node", "노드", "노드js"},
    "Spring": {"spring", "스프링", "자바스프링"},
    "Spring Boot": {"springboot", "스프링부트"},
    "Django": {"django", "장고"},
    "Flask": {"flask", "플라스크"},
    "TensorFlow": {"tensorflow", "텐서플로", "텐서플로우"},
    "PyTorch": {"pytorch", "파이토치"},
    "Keras": {"keras", "케라스"},
    "Pandas": {"pandas", "판다스"},
    "NumPy": {"numpy", "넘파이"},
    "Scikit-learn": {"scikitlearn", "싸이킷런", "사이킷런"},
    "HuggingFace Transformers": {"huggingfacetransformers"},
    "HuggingFace": {"huggingface"},
    "Transformers": {"transformers"},
    "MySQL": {"mysql", "마이에스큐엘", "마이sql"},
    "MongoDB": {"mongodb", "몽고디비", "몽고db"},
    "MariaDB": {"mariadb", "마리아db", "마리아디비"},
    "Redis": {"redis", "레디스"},
    "SQLite": {"sqlite", "에스큐엘라이트"},
    "Oracle": {"oracle", "오라클"},
    "AWS": {"aws", "아마존", "아마존웹서비스"},
    "GCP": {"gcp", "구글클라우드"},
    "Azure": {"azure", "애저"},
    "React Native": {"reactnative"},
    "Android SDK": {"androidsdk"},
    "iOS SDK": {"iossdk"},
    "React": {"react"},
    "Vue": {"vue"},
    "Svelte": {"svelte"},
    "Next.js": {"nextjs"},
    "Nuxt.js": {"nuxtjs"},
    "HTML": {"html"},
    "CSS": {"css"},
    "Go": {"go"},
    "Rust": {"rust"},
    "Swift": {"swift"},
    "Kotlin": {"kotlin"},
    "Dart": {"dart"},
    "Ruby on Rails": {"rubyonrails", "rails"},
    "GraphQL": {"graphql"},
    "REST API": {"restapi"},
    "gRPC": {"grpc"},
    "WebSocket": {"websocket"},
    "Docker": {"docker"},
    "Kubernetes": {"kubernetes"},
    "Terraform": {"terraform"},
    "Jenkins": {"jenkins"},
    "GitHub Actions": {"githubactions"},
    "Heroku": {"heroku"},
    "Vercel": {"vercel"},
    "Netlify": {"netlify"},
    "Cloudflare": {"cloudflare"},
    "FastAPI": {"fastapi"},
    "Express": {"express"},
    "NestJS": {"nestjs"},
    "Redux": {"redux"},
    "Emotion": {"emotion"},
    "Styled Components": {"styledcomponents"},
    "Tailwind": {"tailwind"},
    "Bootstrap": {"bootstrap"},
    "jQuery": {"jquery"},
    "Figma": {"figma"},
    "Webpack": {"webpack"},
    "Parcel": {"parcel"},
    "Vite": {"vite"},
    "Storybook": {"storybook"},
    "Adobe XD": {"adobexd"},
    "Flutter": {"flutter"},
    "Android": {"android"},
    "iOS": {"ios"},
    "PostgreSQL": {"postgresql"},
    "Oracle Cloud": {"oraclecloud"},
    "IBM Cloud": {"ibmcloud"},
    "Alibaba Cloud": {"alibabacloud"},
    "Tencent Cloud": {"tencentcloud"},
    "DigitalOcean": {"digitalocean"},
    "Linode": {"linode"},
    "Vultr": {"vultr"},
    "Hetzner": {"hetzner"},
    "Cloudflare Workers": {"cloudflareworkers"},
}


def normalize_tech_name(name: str) -> str:
    raw = re.sub(r"[\s\-_]", "", name).lower()
    for standard, variants in TECH_EQUIVALENTS.items():
        if raw in variants:
            return standard
    return name


def deduplicate_tech_stack(raw_list):
    """
    기술 리스트를 normalize 기준으로 중복 제거하고 표준 기술명으로 반환
    """
    normalized = {}
    for tech in raw_list:
        norm = normalize_tech_name(tech)
        if norm not in normalized:
            normalized[norm] = tech
    return sorted(set(normalized.values()))
